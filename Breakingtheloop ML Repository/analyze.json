Unique  (cost=224961.24..224961.25 rows=1 width=28)
  CTE bk_dates
    ->  Hash Left Join  (cost=102217.44..207376.31 rows=135012 width=28)
          Hash Cond: (inm.mni_no = nix.mni_no)
          ->  Hash Right Join  (cost=1069.03..99549.49 rows=135012 width=24)
                Hash Cond: (inm.mni_no = bk_1.mni_no)
                ->  Seq Scan on jocojims2inmatedata inm  (cost=0.00..91868.09 rows=382709 width=12)
                ->  Hash  (cost=711.79..711.79 rows=28579 width=12)
                      ->  Seq Scan on jocojimsjailbooking_hashed bk_1  (cost=0.00..711.79 rows=28579 width=12)
          ->  Hash  (cost=89621.85..89621.85 rows=663085 width=12)
                ->  Seq Scan on jocojims2nameindexdata nix  (cost=0.00..89621.85 rows=663085 width=12)
  ->  Sort  (cost=17584.92..17584.93 rows=1 width=28)
        Sort Key: bk.dedupe_id, bk.mni_no, bk.booking_date
        ->  Hash Join  (cost=14369.94..17584.91 rows=1 width=28)
              Hash Cond: (bk.dedupe_id = mh.dedupe_id)
              Join Filter: (mh.dob = bk.dob)
              ->  CTE Scan on bk_dates bk  (cost=0.00..2700.24 rows=135012 width=20)
              ->  Hash  (cost=14369.93..14369.93 rows=1 width=24)
                    ->  Hash Join  (cost=12345.56..14369.93 rows=1 width=24)
                          Hash Cond: ((mh.dedupe_id = mh2.dedupe_id) AND (mh.patid = mh2.patid) AND ((max(mh.dschrg_date)) = mh2.dschrg_date))
                          ->  HashAggregate  (cost=6074.92..6288.01 rows=21309 width=24)
                                Group Key: mh.dedupe_id, mh.patid, mh.dob
                                ->  Seq Scan on jocomentalhealth_hashed mh  (cost=0.00..5813.96 rows=26096 width=24)
                          ->  Hash  (cost=5813.96..5813.96 rows=26096 width=16)
                                ->  Seq Scan on jocomentalhealth_hashed mh2  (cost=0.00..5813.96 rows=26096 width=16)
